<!DOCTYPE html>
<html lang="tr">
    <head>
        {% load static %}
        <meta charset="utf-8" />
        <title>Nebra - Her sayfa bir yÄ±ldÄ±z</title>
        <meta name ="viewport" content="width=device-width, initial-scale=1"/>
        <link rel="stylesheet" href="{% static 'core/style.css' %}">
    </head>
    <body>
        <!-- UST HEADER-->
        <header class="main-header">
            <div class="header-left">
                <img src="{% static 'core/Nebralogo.png' %}" alt="Nebra Logo" class="logo-img">
                <h1 class="brand-title">Nebra âœ¨</h1>
            </div>
            <nav class="header-nav">
                <a href="{% url 'home' %}" class="nav-link {% if not filter_type and not q %}active{% endif %}">ğŸ  Ana Sayfa</a>
                <a href="{% url 'add_book' %}" class="nav-link">ğŸ“– Yeni Kitap Ekle</a>
                <a href="?filter=favorites" class="nav-link {% if filter_type == 'favorites' %}active{% endif %}">â­ Favoriler</a>

                {% if user.is_authenticated %}
                    <span class="nav-link">ğŸ‘‹ {{ user.username }}</span>
                    <a href="{% url 'logout' %}" class="nav-link">ğŸšª Ã‡Ä±kÄ±ÅŸ</a>
                {% else %}
                   <a href="{% url 'login' %}" class="nav-link">ğŸ” GiriÅŸ</a>
                   <a href="{% url 'signup' %}" class="nav-link">ğŸŒ™ KayÄ±t Ol</a>
                {% endif %}
             
            </nav>
        </header>

        <!-- ANA ICERÄ°K-->

        <main class="wrap">

            {% if messages %}
                <div class="toast-wrap">
                    {% for message in messages %}
                    <div class="toast toast-{{ message.tags }}">{{ message }}</div>
                    {% endfor %}
                </div>
            {% endif %}

            <p class="tagline">Her sayfa bir yÄ±ldÄ±z; her hikaye bir iz.</p>

            {% if not user.is_authenticated and not filter_type and not q %}
                <div class="card">
                    <p>ğŸ“š KitaplarÄ±nÄ± kaydetmek iÃ§in Ã¶nce giriÅŸ veya kayÄ±t ol ğŸ’«</p>
                    <a href="{% url 'login' %}" class="btn btn-sm">ğŸ” GiriÅŸ Yap</a>
                    <a href="{% url 'signup' %}" class="btn btn-sm">ğŸ” KayÄ±t Ol</a>
                </div>
            {% endif %}

            <div class="card intro-card">
                <h3>HoÅŸ geldin Ebruli âœ¨</h3>
                <p>OkuduÄŸun kitaplarÄ±, notlarÄ±nÄ± ve yÄ±ldÄ±zlarÄ±nÄ± burada biriktir.</p>
            </div>

            <div class="card book-list">
                <h3>ğŸ“š OkuduÄŸum Kitaplar</h3>

                <form method="get" class="search-form">
                    {% if filter_type == 'favorites' %}
                        <input type="hidden" name="filter" value="favorites">
                    {% endif %}
                    <input type="text" name="q" placeholder="BaÅŸlÄ±k ve yazara gÃ¶re ara..." value="{{ q }}">
                    <button type="submit" class="btn btn-sm">Ara</button> 
                </form>
                <p class="muted">
                    Toplam: {{ books|length }} kitap
                    {% if filter_type == 'favorites' %} â€¢ YalnÄ±zca â­5 Favoriler{% endif %}
                </p>
                {% if books %}
                    <ul>
                        {% for book in books %}
                            <li>
                                <div>
                                    <strong>
                                        <a href="{% url 'book_detail' book.pk %}" class="book-link">{{ book.title }}</a>
                                    </strong>
                                    {% if book.author %}<span class="meta">- {{ book.author}}</span>{% endif %}
                                    {% if book.rating %}<span class="stars"> â­ {{ book.rating}}/5</span>{% endif %}
                                    {% if book.notes %} 
                                        <p class="note-preview">{{ book.notes|truncatechars:120}}</p>
                                    {% endif %}
                                </div>

                                <div class="book-actions">
                                    <a href="{% url 'edit_book' book.pk %}" class="action-link">DÃ¼zenle</a>
                                    <a href="{% url 'delete_book' book.pk %}" class="action-link action-delete">Sil</a>
                                </div>
                            </li>
                        {% endfor %}
                    </ul>
                {% else %}
                    <p>HenÃ¼z kitap yok. Ä°lkini ekleyelim mi? -> <a class="btn" href="{% url 'add_book' %}">ğŸ“– Yeni Kitap Ekle</a></p>
                {% endif %}
            </div>
        </main>
    </body>
</html>